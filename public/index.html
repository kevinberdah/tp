<!DOCTYPE html>
<html lang="en">
<head>
    <title>Plane Shop</title>
    <link rel="shortcut icon" type="image/png" href="images/logo.png" />
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="css/product.css">
    <link rel="stylesheet" href="css/style_accueil.css">
</head>
<body>
    
    <main id="app">
        
        
        <!-- ////////////////////////////////////////////////////// NAV //////////////////////////////////////////////////// -->
        
        
        <nav class="site-header sticky-top py-1" id="nav">
            <div class="container d-flex flex-column flex-md-row justify-content-between">
                <a v-on:click="currentPage='accueil'" class="py-2" id="accueil"><img class="logoheader" src="images/logoheader.png" /></a>
                <a v-on:click="currentPage='airbus'" class="py-2 d-none d-md-inline-block" id="airbus">Airbus</a>
                <a v-on:click="currentPage='boeing'" class="py-2 d-none d-md-inline-block" id="boeing">Boeing</a>
                <a v-on:click="currentPage='dassault'" class="py-2 d-none d-md-inline-block" id="dassault">Dassault</a>
                <a v-on:click="currentPage='entreprise'" class="py-2 d-none d-md-inline-block" id="entreprise">Entreprise</a>
                <div v-if="utilisateur.mail === ''">
                    <a v-on:click="currentPage='login'" class="py-2 d-none d-md-inline-block" id="login">Login</a>
                </div>
                <div v-else>
                    <a v-on:click="currentPage = 'login'" class="py-2 d-none d-md-inline-block" id="login"><strong>Bonjour {{ infos.prenom }}</strong><a>
                </div>
                        <a v-on:click="currentPage='panier'" class="py-2 d-none d-md-inline-block" id="panier">Panier</a>
            </div>
        </nav>
                
                
                <!-- ////////////////////////////////////////////////////// ACCUEIL //////////////////////////////////////////////////// -->
                
                <section v-if="currentPage==='accueil'" id="accueil">
                    <ul>
                        <li>
                            <div class="emirates_airbus">
                                <a v-on:click="currentPage='airbus'" class="emirates_airbus">
                                    <img class="emirates_airbus" src="images/Airbus380.jpg" />
                                    <div class="more">
                                        <a v-on:click="currentPage='airbus'" class="more1">En savoir plus ></a>
                                        <a v-on:click="currentPage='airbus'" class="more2">Acheter ></a>
                                    </div>
                                </a>
                            </div>
                        </li>
                        
                        <li>
                            <div class="boeing_787">
                                <a v-on:click="currentPage='boeing'" class="boeing_787">
                                    <img class="boeing_787" src="images/Boeing.jpg" />
                                    <div class="more3">
                                        <a v-on:click="currentPage='boeing'" class="more4">En savoir plus ></a>
                                        <a v-on:click="currentPage='boeing'" class="more5">Acheter ></a>
                                    </div>
                                </a>
                            </div>
                            
                        </li>
                        
                        <li>
                            <div class="rafale">
                                <a v-on:click="currentPage='dassault'" class="rafale">
                                    <img class="rafale" src="images/RafaleM.jpg" />
                                    <div class="more6">
                                        <a v-on:click="currentPage='dassault'" class="more7">En savoir plus ></a>
                                        <a v-on:click="currentPage='dassault'" class="more8">Acheter ></a>
                                    </div>
                                </a>
                            </div>
                        </li>
                    </ul>
                </section>
                
                
                
                <!-- ////////////////////////////////////////////////////// AIRBUS //////////////////////////////////////////////////// -->
                
                
                <section v-if="currentPage==='airbus'" id="airbus">
                    
                    <div>
                        <img class="logo_airbus" src="images/logoairbus.png" />
                    </div>
                    
                    
                    <div class="album py-5 bg-light" id="articles">
                        <div class="container">
                            
                            <div v-for="(item, index) in myItems" v-if="index <= 2" class="row">
                                <div class="col-md-4">
                                    <div class="card mb-4 shadow-sm" id="article1">
                                        <img id="images" class="card-img-top" v-bind:src=item.src alt="Card image cap" />
                                        
                                        <div class="card-body">
                                            <h5 class="card-title">{{ item.name }}</h5>
                                            <p class="card-text">{{ item.description }}</p>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <div class="btn-group">
                                                    <button v-on:click="ajouterPanier(item, index)" type="button" class="btn btn-sm btn-outline-primary">Commander ({{ item.nombre }})</button>
                                                </div>
                                                <div class="btn-group">
                                                    <button v-on:click="retirerProduit(item, index)" type="button" class="btn btn-sm btn-outline-danger">Retirer</button>
                                                </div>
                                                <strong class="text-muted">{{ item.prix }} M €</strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                </section>
                
                
                <!-- ////////////////////////////////////////////////////// BOEING //////////////////////////////////////////////////// -->
                
                <section v-else-if="currentPage==='boeing'" id="boeing">
                    
                    <div>
                        <img class="logo_boeing" src="images/logoboeing.png" />
                    </div>
                    
                    <div class="album py-5 bg-light" id="articles">
                        <div class="container">
                            
                            <div v-for="(item, index) in myItems" v-if="index > 2 & index <=4" class="row">
                                <div class="col-md-4">
                                    <div class="card mb-4 shadow-sm" id="article1">
                                        <img id="images" class="card-img-top" v-bind:src=item.src alt="Card image cap" />
                                        
                                        <div class="card-body">
                                            <h5 class="card-title">{{ item.name }}</h5>
                                            <p class="card-text">{{ item.description }}</p>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <div class="btn-group">
                                                    <button v-on:click="ajouterPanier(item, index)" type="button" class="btn btn-sm btn-outline-primary">Commander ({{ item.nombre }})</button>
                                                </div>
                                                <div class="btn-group">
                                                    <button v-on:click="retirerProduit(item, index)" type="button" class="btn btn-sm btn-outline-danger">Retirer</button>
                                                </div>
                                                <strong class="text-muted">{{ item.prix }} M €</strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                </section>  
                
                
                
                
                <!-- ////////////////////////////////////////////////////// DASSAULT //////////////////////////////////////////////////// -->
                
                
                <section v-else-if="currentPage==='dassault'" id="dassault">
                    
                    <div>
                        <img class="logo_dassault" src="images/logodassault.png" />
                    </div>
                    
                    <div class="album py-5 bg-light" id="articles">
                        <div class="container">
                            
                            <div v-for="(item, index) in myItems" v-if="index > 4" class="row">
                                <div class="col-md-4">
                                    <div class="card mb-4 shadow-sm" id="article1">
                                        <img id="images" class="card-img-top" v-bind:src=item.src alt="Card image cap" />
                                        
                                        <div class="card-body">
                                            <h5 class="card-title">{{ item.name }}</h5>
                                            <p class="card-text">{{ item.description }}</p>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <div class="btn-group">
                                                    <button v-on:click="ajouterPanier(item, index)" type="button" class="btn btn-sm btn-outline-primary">Commander ({{ item.nombre }})</button>
                                                </div>
                                                <div class="btn-group">
                                                    <button v-on:click="retirerProduit(item, index)" type="button" class="btn btn-sm btn-outline-danger">Retirer</button>
                                                </div>
                                                
                                                <strong class="text-muted">{{ item.prix }} M €</strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                </section>
                
                
                <!-- ////////////////////////////////////////////////////// ENTREPRISE //////////////////////////////////////////////////// -->
                
                
                <section v-else-if="currentPage==='entreprise'" id="entreprise">
                    
                    
                    <div class="gauche">
                        <p>
                            <strong>Création</strong> : 18 décembre 1970<br><br>
                            <strong>Fondateurs</strong> : Younes Ghenai, Kevin Berdah<br><br>
                            <strong>Siège social</strong> : Paris<br><br>
                            <strong>Activité</strong> : Aéronautique<br><br>
                            <strong>Produits</strong> : Avions civils passagers, affaires et fret, avions militaires<br><br>
                            <strong>Chiffre d’affaires</strong> : en augmentation de 118.4 milliards d'euros (2017) +7.4%<br> <br>
                            <strong>Résultat net</strong> : en augmentation de 4.423 milliards d'euros (2017) +1.6% 
                        </p>
                    </div>
                    
                    <div class="paraf">
                        
                        <div class="bande">
                            <img class="logoentreprise" src="images/logoo.png"/></a>
                        </div>
                        <br><br>
                        <p>PS, connu sous le nom de Plane Shop est un constructeur aéronautique européen dont le siège social se trouve à Paris, en France. Division détenue à parts égales par les deux fondateurs de l'entreprise dont celle-ci fabrique plus de la moitié des avions de lignes produits dans le monde.</p>
                        
                        <p>Plane Shop fut fondé en tant que consortium par des fabricants européens à la fin des années 1960. Plane Shop Industry est devenue une SAS (société par actions simplifiée) en 2001, filiale d’EADS renommée Plane Shop Group en 2014 puis Plane Shop en 2017.</p>
                        
                        <p>Ainsi en 2010, 62 751 personnes sont employées sur 18 sites de Plane Shop situés en France, aux Etats-Unis et au Qatar. Même si les pièces des avions Airbus sont essentiellement fabriquées en Europe certaines proviennent du monde entier.</p>
                        
                        <p>Plane Shop a été le premier constructeur et revendeur à installer un système de commandes de vol électrique sur l'A320.
                            En 2013, Plane Shop a produit 626 avions et décroché 1 503 commandes. Il s'agit du plus beau résultat commercial de l'histoire de l'aéronautique. Début 2017, Plane Shop annonce avoir battu son propre record de livraisons avec la production de 688 avions cette année. Le 15 novembre 2017, Plane Shop décroche la plus importante commande de l'histoire de l'aéronautique en vendant au loueur Américain Indigo un total de 128 Boeing 787 Dreamline, pour une valeur catalogue évaluée à près de 50 milliards de dollars US.</p>
                            
                            <p><strong>Retour produit</strong> : 88 Avenue de la Grande Cour, 31200 - Toulouse </p> 
                            <p><strong>Contactez-nous</strong> : 05-61-93-55-55</p>   
                        </div>
                    </section>
                    
                    <!-- //////////////////////////////////////////////////////// LOGIN ////////////////////////////////////////////////////// -->
                    
                    <section v-else-if="currentPage === 'login'" id="login">
                        <div v-if="utilisateur.mail === ''" class="page_login"> 
                            <h4 class="titre_connexion">Connexion à votre espace personnel</h4>
                            <div id="back" class="row">
                                <div id="connexion">
                                    <div class="sing_in">
                                        <form class="form-signin">
                                            <input v-model="user.mail" type="email" id="inputEmail" class="form-control mb-3" placeholder="Email ">
                                            <input v-model="user.mdp" type="password" id="inputpassword" class="form-control mb-3" placeholder="Mot de passe">
                                            <button v-on:click="login(), infosclient()" id="signin" class="btn btn-lg btn-primary btn-block" type="button">Connexion</button>
                                        </form>
                                    </div>
                                </div>
                                <div id="inscription">
                                    <div>
                                        <h1 class="titre_inscription">Vous n'avez pas de compte ? Inscrivez-vous gratuitement.</h1>
                                        <div class="sign_up">
                                            <form class="form-signin">
                                                <input v-model="add_user.nom" type="text" id="imputNom" class="form-control mb-3" placeholder="Nom">
                                                <input v-model="add_user.prenom" type="text" id="imputPrénom" class="form-control mb-3" placeholder="Prénom">
                                                <input v-model="add_user.mail" type="email" id="inputMail" class="form-control mb-3" placeholder="Email">
                                                <input v-model="add_user.mdp" type="password" id="inputMotdepasse" class="form-control mb-3" placeholder="Mot de passe">
                                                <input v-model="add_user.age" type="date" id="inputAge" class="form-control mb-3" placeholder="date de naissance">
                                                <input v-model="add_user.adresse" type="city" id="inputAdresse" class="form-control mb-3" placeholder="Adresse">
                                                <input v-model="add_user.ville" type="text" id="inputVille" class="form-control mb-3" placeholder="Ville">
                                                <button v-on:click="adduser(), infosclient()" id="signup" class="btn btn-lg btn-primary btn-block mb-3" type="button">Inscription</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div v-else>
                            <h1>Infos Client</h1>
                            <div class="infosclient">
                                <p><b>Nom : </b>{{ infos.nom }}</p>
                                <p><b>Prénom : </b>{{ infos.prenom }}</p>
                                <p><b>Adresse mail : </b>{{ infos.mail }}</p>
                                <p><b>Adresse de facturation : </b>{{ infos.adresse }}</p>
                                <p><b>Ville : </b>{{ infos.ville }}</p>
                            </div>
                        </div>
                        
                    </section>
                    
                    
                    <!-- //////////////////////////////////////////////////////// PANIER ////////////////////////////////////////////////////// -->
                    
                    <section v-else-if="currentPage==='panier'" id="panier">
                        
                        <div id="h3">
                            <img class="sac" src="images/sac.png"/>
                            <h3>VOTRE PANIER </h3>
                        </div>
                        
                        <div id="commandes">
                            
                            <li v-for="(item, index) in myPanier" v-if="item.quantity >= 1">
                                <img id="images" class="card-img-top" v-bind:src=item.src alt="Card image cap" />
                                <strong>{{ item.name }}</strong>
                                <p> Prix : {{ item.prix }} M € </p>
                                <p> 
                                    <button v-on:click="retirerProduit(item, index)" type="button" class="btn btn-sm btn-outline-danger"> - </button> 
                                    Quantité : {{ item.quantity }} 
                                    <button v-on:click="ajouterPanier(item, index)" type="button" class="btn btn-sm btn-outline-success"> + </button>
                                </p>
                                <strong> Sous-total : {{ item.soustotal }} M €</strong>
                            </li>
                            
                        </div>
                        
                        <div>
                            <h4 id="total">TOTAL : {{ this.myPanier[0].soustotal + this.myPanier[1].soustotal + this.myPanier[2].soustotal + this.myPanier[3].soustotal + this.myPanier[4].soustotal + this.myPanier[5].soustotal }} M €</h4>
                        </div>
                        
                        <div id="acheter">
                            <button v-if="utilisateur.mail === ''"  v-on:click="currentPage='login'" type="button" class="btn btn-dark" title="Veuillez vous connecter pour valider votre panier"> Valider et payer </button>
                            <button v-else v-on:click="currentPage='confirmation'" type="button" class="btn btn-success"> Valider et payer </button>
                        </div>
                        
                    </section>
                    
                    <!-- v-if="utilisateur.mail != '' & item.quantity = 0" -->
                    
                    
                    <!-- ////////////////////////////////////////////////////// CONFIRMATION //////////////////////////////////////////////////// -->
                    
                    
                    <section v-else-if="currentPage==='confirmation'" id="confirmation">
                        <p>
                            Merci d'avoir acheté chez Plane Shop <br> à très bientôt ! 
                        </p>
                        
                    </section>
                    
                    
                    <!-- ////////////////////////////////////////////////////// FOOTER //////////////////////////////////////////////////// -->
                    
                    <footer class="container py-5" id="footer">
                        <div class="row">
                            <div class="col-12 col-md">
                                <img class="logofooter" src="images/logo.png" width="40" height="40" viewbox="0 0 40 40" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="d-block mb-2" />
                                
                                <small class="d-block mb-3 text-muted">&copy; 2018-2019</small>
                            </div>
                            <div class="col-6 col-md">
                                <h5>Nos produits</h5>
                                <ul class="list-unstyled text-small">
                                    <li><a v-on:click="currentPage='airbus'" class="text-muted">Airbus</a></li>
                                    <li><a v-on:click="currentPage='boeing'" class="text-muted">Boeing</a></li>
                                    <li><a v-on:click="currentPage='dassault'" class="text-muted">Dassault</a></li>
                                    <li><a v-on:click="currentPage='accueil'" class="text-muted">Tous les avions</a></li>
                                </ul>
                            </div>
                            <div class="col-6 col-md">
                                <h5>Implantation</h5>
                                <ul class="list-unstyled text-small">
                                    <li><a class="text-muted">France</a></li>
                                    <li><a class="text-muted">Etats-Unis</a></li>
                                    <li><a class="text-muted">Qatar</a></li>
                                </ul>
                            </div>
                            <div class="col-6 col-md">
                                <h5>Service Client</h5>
                                <ul class="list-unstyled text-small">
                                    <li><a v-on:click="currentPage='panier'" class="text-muted">Panier</a></li>
                                    <li><a v-on:click="currentPage='entreprise'" class="text-muted">Retour produit</a></li>
                                </ul>
                            </div>
                            <div class="col-6 col-md">
                                <h5>Informations</h5>
                                <ul class="list-unstyled text-small">
                                    <li><a v-on:click="currentPage='entreprise'" class="text-muted">Equipe</a></li>
                                    <li><a v-on:click="currentPage='entreprise'" class="text-muted">Contact</a></li>
                                    <li><a v-on:click="currentPage='entreprise'" class="text-muted">Support</a></li>
                                </ul>
                            </div>
                        </div>
                    </footer>
                    
                    
                    
                </main>
                
                
                
                
                
                <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.15.2/axios.js"></script>
                <script>
                    // Sans cette ligne + l'import de axios.js (2e <script>), this.$http ne fonctionnera pas
                        Vue.prototype.$http = axios
                        
                        const app = new Vue({
                            el: '#app',
                            data: {
                                currentPage: 'accueil',
                                filter: '',
                                menu: '',
                                myItems: [],
                                myPanier: [],
                                user: {
                                    mail: '',
                                    mdp: '',
                                },
                                add_user: {
                                    prenom: '',
                                    nom: '',
                                    mail: '',
                                    mdp: '',
                                    adresse: '',
                                    ville: '',
                                },
                                utilisateur: {
                                    mail: ''
                                },
                                infos: {
                                    nom: '',
                                    adresse: '',
                                    prenom: '',
                                    ville: '',
                                    mail: ''
                                }
                            },
                            
                            methods: {
                                ajouterPanier: function (item, index) {
                                    this.$http.post('/panier', {
                                        id: this.myItems[index].id
                                    })
                                    .then((response) => {
                                        if(response.data === 'OK'){
                                            this.myPanier[index].quantity += 1
                                            this.myItems[index].stock -= 1
                                            this.myItems[index].nombre += 1
                                            this.myPanier[index].soustotal = this.myItems[index].prix * this.myPanier[index].quantity
                                            //this.myPanier.total = this.myPanier[0].soustotal + this.myPanier[1].soustotal + this.myPanier[2].soustotal + this.myPanier[3].soustotal + this.myPanier[4].soustotal + this.myPanier[5].soustotal
                                        }else{
                                            alert(response.data)
                                        }
                                    })
                                },
                                
                                retirerProduit: function (item, index) {
                                    this.$http.post('/items', {
                                        id: this.myPanier[index].id
                                    })
                                    .then((response) => {
                                        if(response.data === 'OK') {
                                            this.myPanier[index].quantity -= 1
                                            this.myItems[index].stock += 1
                                            this.myItems[index].nombre -=1
                                            this.myPanier[index].soustotal = this.myItems[index].prix * this.myPanier[index].quantity
                                            // this.myPanier.total = this.myPanier[0].soustotal + this.myPanier[1].soustotal + this.myPanier[2].soustotal + this.myPanier[3].soustotal + this.myPanier[4].soustotal + this.myPanier[5].soustotal
                                        } else {
                                            alert(response.data)
                                        }
                                        
                                    })
                                },
                                
                                
                                
                                login: function() {
                                    this.$http.post('/users', {
                                        mail: this.user.mail,
                                        mdp: this.user.mdp
                                    })
                                    .then((response) => {
                                        if (response.data === 'OK') {
                                            console.log('ok');
                                            alert("Vous êtes maintenant connectés")
                                            this.utilisateur.mail = this.user.mail
                                            this.currentPage = 'panier'
                                        } else {
                                            console.log(response.data);
                                            alert(response.data)
                                        }
                                    })
                                },
                                
                                adduser: function() {
                                    if (this.add_user.prenom != '' && this.add_user.nom != '' && this.add_user.adresse != '' && this.add_user.age != '' && this.add_user.mdp != '' && this.add_user.mail != '' && this.add_user.ville != '') {
                                        this.$http.post('/createUser', {
                                            prenom: this.add_user.prenom,
                                            nom: this.add_user.nom,
                                            age: this.add_user.age,
                                            mail: this.add_user.mail,
                                            mdp: this.add_user.mdp,
                                            adresse: this.add_user.adresse,
                                            ville: this.add_user.ville
                                        })
                                        .then((response) => {
                                            if (response.data === 'OK') {
                                                this.utilisateur.mail = this.add_user.mail
                                                alert('Bienvenue sur Plane Shop !')
                                                this.currentPage = 'infosclient'
                                            }
                                        })
                                    } else {
                                        alert('Veuillez compléter les informations');
                                    }
                                },
                                
                                infosclient: function() {
                                    this.$http.get('/infosclient')
                                    .then(users => {
                                        users.data.forEach(element => {
                                            if (element.mail === this.user.mail) {
                                                this.infos.mail = element.mail;
                                                this.infos.nom = element.nom;
                                                this.infos.prenom = element.prenom;
                                                this.infos.adresse = element.adresse;
                                                this.infos.ville = element.ville
                                            }
                                        })
                                    })
                                },
                                
                                
                                
                            },
                            
                            
                            
                            created () {
                                this.$http.get('/items')
                                .then(items => {
                                    console.log('affichage de ma gantse', items)
                                    this.myItems = items.data
                                })
                                .catch(err => {
                                    console.log('error', err)
                                })
                                
                                
                                this.$http.get('/panier')
                                .then(panier => {
                                    console.log('affichage de ma gantse', panier)
                                    this.myPanier = panier.data
                                })
                                .catch(err => {
                                    console.log('error', err)
                                })
                                
                            },
                            
                        })
                    </script>
                    
                </body>
                </html>
